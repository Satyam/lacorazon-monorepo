<script server>
  const { get } = require('~/dist/data/vendedores.js');

  server.get('/', async (req, res) => {
    const vendedor = await get(req.query.id);
    res.render(
      self,
      { vendedor, readonly: true },
      req.isHtmx ? ['main', 'heading', 'title', 'details'] : []
    );
  });

  server.patch('/', async (req, res) => {
    const { id, tab } = req.query;
    res.render(
      self,
      {
        details: {
          ventas: tab === 'ventas',
          consigna: tab === 'consigna',
        },
      },
      'details'
    );
  });
</script>

<title id="title">La Corazón - Vendedor: {= vendedor.nombre}</title>
<h1 id="heading">Detalle vendedor</h1>
<main id="main">{> vendedores/__form}</main>
<div id="details" class="wide">
  {? details.ventas}
  <details
    open
    hx-patch="/vendedores/ver?id={= item.id}"
    hx-swap="none"
    class="card"
  >
    <summary class="card-header">Ventas</summary>
    <p class="card-body">Aquí van las ventas</p>
  </details>
  {: details.ventas}
  <details
    hx-patch="/vendedores/ver?id={= item.id}&tab=ventas"
    hx-swap="none"
    class="card"
  >
    <summary class="card-header">Ventas</summary>
  </details>
  {/? details.ventas} {? details.consigna}
  <details
    open
    hx-patch="/vendedores/ver?id={= item.id}"
    hx-swap="none"
    class="card"
  >
    <summary class="card-header">Consigna</summary>
    <p class="card-body">Aquí va la consigna</p>
  </details>
  {: details.consigna}
  <details
    hx-patch="/vendedores/ver?id={= item.id}&tab=consigna"
    hx-swap="none"
    class="card"
  >
    <summary class="card-header">Consigna</summary>
  </details>
  {/? details.consigna}
</div>

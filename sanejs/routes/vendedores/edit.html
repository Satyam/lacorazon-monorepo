---
title: La Coraz贸n - Vendedor
header: Modificar vendedor
---

<script server>
  const { get } = require('~/dist/data/vendedores.js');

  server.get('/', async (req, res) => {
    const { id, nombre } = req.query;
    console.log('modificar vendedor', { id, nombre });
    if (id) {
      const vendedor = await get(id);
      res.render(
        self,
        {
          vendedor,
          title: `La Coraz贸n - Vendedor - ${vendedor.nombre}`,
          header: 'Modificar vendedor',
        },
        req.isHtmx ? ['main', 'menu'] : []
      );
    } else {
      const vendedor = { nombre: '', email: '' };
      res.render(
        self,
        {
          vendedor,
          title: `La Coraz贸n - Nuevo Vendedor`,
          header: 'Alta vendedor',
        },
        req.isHtmx ? ['main', 'menu'] : []
      );
    }
  });

  server.post('/', async (req, res) => {
    console.log('vendedor post', req.body);
    res.render(
      self,
      {
        vendedor: req.body,
        title: `La Coraz贸n - Nuevo Vendedor`,
        header: 'Alta vendedor',
      },
      req.isHtmx ? ['main', 'menu'] : []
    );
  });
</script>
<form-wrapper id="form" novalidate>
  <text-field
    label="Nombre"
    name="nombre"
    value="{= vendedor.nombre}"
    placeholder="Nombre"
  ></text-field>
  <email-field
    label="Email"
    name="email"
    value="{= vendedor.email}"
    placeholder="Email"
  ></email-field>
  {? authFailed }
  <span class="text-error">Authentication failed</span>
  {/? authFailed }
  <button type="submit" class="btn btn-primary">Aceptar</button>
</form-wrapper>
<script>
  function onSubmit(ev) {
    const vendedor = ev.values;
    console.log(vendedor);
    htmx.ajax('POST', '/vendedores/edit', {
      swap: false,
      values: vendedor,
    });
  }
  const formEl = document.getElementById('form');
  if (formEl) {
    formEl.addEventListener('formSubmit', onSubmit);
  }
</script>
